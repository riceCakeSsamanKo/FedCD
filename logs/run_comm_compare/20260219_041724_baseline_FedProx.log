
[Info] Experiment logs will be saved to: /home/mulsoap0504/FedCD/FedCD-Baseline/logs/FedProx/GM_VGG8/pat/NC_20/date_20260219/time_043012

==================================================
goal = train
device = cuda
device_id = 0
dataset = Cifar10_pat_nc20
num_classes = 10
model = VGG8
batch_size = 128
local_learning_rate = 0.005
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 5
top_cnt = 100
local_epochs = 2
algorithm = FedProx
join_ratio = 1.0
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
eval_common_global = True
global_test_samples = 0
common_eval_batch_size = 256
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 80
max_len = 200
few_shot = 0
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
first_stage_bound = 0
fedcross_alpha = 0.99
collaberative_model_select_strategy = 1
exp_dir = /home/mulsoap0504/FedCD/FedCD-Baseline/logs/FedProx/GM_VGG8/pat/NC_20/date_20260219/time_043012
log_path = /home/mulsoap0504/FedCD/FedCD-Baseline/logs/FedProx/GM_VGG8/pat/NC_20/date_20260219/time_043012/acc.csv
==================================================

============= Running time: 0th =============
Creating server and clients ...
VGG8(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (5): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU(inplace=True)
    (7): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (8): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (12): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): ReLU(inplace=True)
    (14): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (classifier): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=10, bias=True)
  )
)
[Baseline] Global Test Set Size: 10000

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]Distributing models:  90%|█████████ | 18/20 [00:00<00:00, 171.80it/s]                                                                     
-------------Round number: 0-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:   5%|▌         | 1/20 [00:00<00:11,  1.64it/s]Testing clients:  15%|█▌        | 3/20 [00:00<00:03,  4.66it/s]Testing clients:  25%|██▌       | 5/20 [00:00<00:02,  7.04it/s]Testing clients:  35%|███▌      | 7/20 [00:01<00:01,  9.12it/s]Testing clients:  45%|████▌     | 9/20 [00:01<00:01, 10.69it/s]Testing clients:  55%|█████▌    | 11/20 [00:01<00:00, 11.05it/s]Testing clients:  65%|██████▌   | 13/20 [00:01<00:00, 11.92it/s]Testing clients:  75%|███████▌  | 15/20 [00:01<00:00, 12.85it/s]Testing clients:  85%|████████▌ | 17/20 [00:01<00:00, 13.25it/s]Testing clients:  95%|█████████▌| 19/20 [00:01<00:00, 13.40it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:07,  2.58it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:06,  2.83it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:05,  2.90it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  2.97it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.98it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:04,  2.97it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  2.92it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:04,  2.99it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:02<00:03,  3.19it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  3.17it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:03<00:02,  3.12it/s]Calculating train metrics:  60%|██████    | 12/20 [00:03<00:02,  3.05it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:04<00:02,  2.98it/s]Calculating train metrics:  70%|███████   | 14/20 [00:04<00:02,  2.98it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  2.96it/s]Calculating train metrics:  80%|████████  | 16/20 [00:05<00:01,  2.94it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:05<00:01,  2.93it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  2.94it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:06<00:00,  2.95it/s]Calculating train metrics: 100%|██████████| 20/20 [00:06<00:00,  2.94it/s]                                                                          Averaged Train Loss: 2.3035
Averaged Local Test Accuracy: 0.1000
Averaged Global Test Accuracy: 0.1000
Averaged Test AUC: 0.5009
Std Test Accuracy: 0.2000
Std Test AUC: 0.1982
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]Aggregating models:   5%|▌         | 1/20 [00:00<00:01,  9.93it/s]Aggregating models:  15%|█▌        | 3/20 [00:00<00:01, 13.39it/s]Aggregating models:  50%|█████     | 10/20 [00:00<00:00, 36.69it/s]                                                                   ------------------------- time cost ------------------------- 28.27281165122986
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]Distributing models:  15%|█▌        | 3/20 [00:00<00:00, 28.88it/s]                                                                   
-------------Round number: 1-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:  10%|█         | 2/20 [00:00<00:01, 12.31it/s]Testing clients:  20%|██        | 4/20 [00:00<00:01, 12.59it/s]Testing clients:  30%|███       | 6/20 [00:00<00:01, 13.57it/s]Testing clients:  40%|████      | 8/20 [00:00<00:01, 11.35it/s]Testing clients:  50%|█████     | 10/20 [00:00<00:00, 12.01it/s]Testing clients:  60%|██████    | 12/20 [00:00<00:00, 12.29it/s]Testing clients:  70%|███████   | 14/20 [00:01<00:00, 12.83it/s]Testing clients:  80%|████████  | 16/20 [00:01<00:00, 13.78it/s]Testing clients:  90%|█████████ | 18/20 [00:01<00:00, 14.67it/s]Testing clients: 100%|██████████| 20/20 [00:01<00:00, 15.19it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:06,  2.75it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:06,  2.80it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:05,  2.90it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  2.94it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.80it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:04,  2.86it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  2.92it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:04,  2.85it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:03<00:03,  2.99it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  2.91it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:03<00:03,  2.84it/s]Calculating train metrics:  60%|██████    | 12/20 [00:04<00:02,  2.81it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:04<00:02,  2.78it/s]Calculating train metrics:  70%|███████   | 14/20 [00:04<00:02,  2.95it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  2.97it/s]Calculating train metrics:  80%|████████  | 16/20 [00:05<00:01,  3.16it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:05<00:00,  3.27it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  3.05it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:06<00:00,  3.12it/s]Calculating train metrics: 100%|██████████| 20/20 [00:06<00:00,  3.09it/s]                                                                          Averaged Train Loss: 2.2152
Averaged Local Test Accuracy: 0.4129
Averaged Global Test Accuracy: 0.1109
Averaged Test AUC: 0.6153
Std Test Accuracy: 0.1600
Std Test AUC: 0.1389
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]                                                          ------------------------- time cost ------------------------- 29.073878049850464
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]                                                           
-------------Round number: 2-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:  10%|█         | 2/20 [00:00<00:01, 14.77it/s]Testing clients:  20%|██        | 4/20 [00:00<00:01, 13.46it/s]Testing clients:  30%|███       | 6/20 [00:00<00:00, 14.74it/s]Testing clients:  40%|████      | 8/20 [00:00<00:00, 15.22it/s]Testing clients:  50%|█████     | 10/20 [00:00<00:00, 15.00it/s]Testing clients:  60%|██████    | 12/20 [00:00<00:00, 14.50it/s]Testing clients:  70%|███████   | 14/20 [00:01<00:00, 12.77it/s]Testing clients:  80%|████████  | 16/20 [00:01<00:00, 12.96it/s]Testing clients:  90%|█████████ | 18/20 [00:01<00:00, 13.19it/s]Testing clients: 100%|██████████| 20/20 [00:01<00:00, 13.56it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:06,  2.84it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:06,  2.76it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:05,  2.87it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  2.82it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.77it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:04,  2.97it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  3.07it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:03,  3.06it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:03<00:03,  2.85it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  2.86it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:03<00:03,  2.89it/s]Calculating train metrics:  60%|██████    | 12/20 [00:04<00:02,  2.68it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:04<00:02,  2.74it/s]Calculating train metrics:  70%|███████   | 14/20 [00:04<00:02,  2.73it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  2.71it/s]Calculating train metrics:  80%|████████  | 16/20 [00:05<00:01,  2.75it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:06<00:01,  2.78it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  2.78it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:06<00:00,  2.84it/s]Calculating train metrics: 100%|██████████| 20/20 [00:07<00:00,  3.00it/s]                                                                          Averaged Train Loss: 2.1689
Averaged Local Test Accuracy: 0.4230
Averaged Global Test Accuracy: 0.1374
Averaged Test AUC: 0.6677
Std Test Accuracy: 0.0930
Std Test AUC: 0.0968
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]                                                          ------------------------- time cost ------------------------- 28.785566329956055
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]                                                           
-------------Round number: 3-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:  10%|█         | 2/20 [00:00<00:01, 13.43it/s]Testing clients:  20%|██        | 4/20 [00:00<00:01, 13.85it/s]Testing clients:  30%|███       | 6/20 [00:00<00:01, 13.21it/s]Testing clients:  40%|████      | 8/20 [00:00<00:00, 13.30it/s]Testing clients:  50%|█████     | 10/20 [00:00<00:00, 13.54it/s]Testing clients:  60%|██████    | 12/20 [00:00<00:00, 13.48it/s]Testing clients:  70%|███████   | 14/20 [00:01<00:00, 13.12it/s]Testing clients:  80%|████████  | 16/20 [00:01<00:00, 11.83it/s]Testing clients:  90%|█████████ | 18/20 [00:01<00:00, 11.99it/s]Testing clients: 100%|██████████| 20/20 [00:01<00:00, 12.60it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:06,  2.82it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:06,  2.86it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:05,  2.89it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  2.79it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.82it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:05,  2.80it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  2.97it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:04,  2.92it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:03<00:03,  2.85it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  3.02it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:03<00:03,  2.96it/s]Calculating train metrics:  60%|██████    | 12/20 [00:04<00:02,  3.05it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:04<00:02,  2.97it/s]Calculating train metrics:  70%|███████   | 14/20 [00:04<00:01,  3.05it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  3.06it/s]Calculating train metrics:  80%|████████  | 16/20 [00:05<00:01,  3.00it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:05<00:01,  2.97it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  2.99it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:06<00:00,  2.82it/s]Calculating train metrics: 100%|██████████| 20/20 [00:06<00:00,  2.84it/s]                                                                          Averaged Train Loss: 2.1688
Averaged Local Test Accuracy: 0.3913
Averaged Global Test Accuracy: 0.1627
Averaged Test AUC: 0.6772
Std Test Accuracy: 0.1083
Std Test AUC: 0.0570
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]                                                          ------------------------- time cost ------------------------- 28.719918251037598
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]                                                           
-------------Round number: 4-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:   5%|▌         | 1/20 [00:00<00:02,  6.58it/s]Testing clients:  15%|█▌        | 3/20 [00:00<00:01, 10.84it/s]Testing clients:  25%|██▌       | 5/20 [00:00<00:01, 13.11it/s]Testing clients:  35%|███▌      | 7/20 [00:00<00:01, 12.25it/s]Testing clients:  45%|████▌     | 9/20 [00:00<00:00, 11.98it/s]Testing clients:  55%|█████▌    | 11/20 [00:00<00:00, 13.10it/s]Testing clients:  65%|██████▌   | 13/20 [00:01<00:00, 13.41it/s]Testing clients:  75%|███████▌  | 15/20 [00:01<00:00,  8.25it/s]Testing clients:  85%|████████▌ | 17/20 [00:01<00:00,  9.05it/s]Testing clients:  95%|█████████▌| 19/20 [00:01<00:00, 10.07it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:06,  2.78it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:07,  2.49it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:06,  2.73it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  2.92it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.94it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:04,  3.06it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  2.93it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:04,  2.75it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:03<00:04,  2.65it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  2.80it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:03<00:03,  2.86it/s]Calculating train metrics:  60%|██████    | 12/20 [00:04<00:02,  3.00it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:04<00:02,  2.96it/s]Calculating train metrics:  70%|███████   | 14/20 [00:04<00:02,  2.86it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  2.70it/s]Calculating train metrics:  80%|████████  | 16/20 [00:05<00:01,  2.73it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:06<00:01,  2.65it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  2.65it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:06<00:00,  2.77it/s]Calculating train metrics: 100%|██████████| 20/20 [00:07<00:00,  2.87it/s]                                                                          Averaged Train Loss: 2.1671
Averaged Local Test Accuracy: 0.3622
Averaged Global Test Accuracy: 0.1846
Averaged Test AUC: 0.6785
Std Test Accuracy: 0.1297
Std Test AUC: 0.0435
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]                                                          ------------------------- time cost ------------------------- 30.385180950164795
Distributing models:   0%|          | 0/20 [00:00<?, ?it/s]Distributing models:  50%|█████     | 10/20 [00:00<00:00, 77.27it/s]Distributing models:  90%|█████████ | 18/20 [00:00<00:00, 66.53it/s]                                                                    
-------------Round number: 5-------------

Evaluate global model
Testing clients:   0%|          | 0/20 [00:00<?, ?it/s]Testing clients:   5%|▌         | 1/20 [00:00<00:02,  8.14it/s]Testing clients:  15%|█▌        | 3/20 [00:00<00:01, 10.36it/s]Testing clients:  25%|██▌       | 5/20 [00:00<00:01, 11.97it/s]Testing clients:  35%|███▌      | 7/20 [00:00<00:01, 11.16it/s]Testing clients:  45%|████▌     | 9/20 [00:00<00:01, 10.76it/s]Testing clients:  55%|█████▌    | 11/20 [00:00<00:00, 11.43it/s]Testing clients:  65%|██████▌   | 13/20 [00:01<00:00, 11.83it/s]Testing clients:  75%|███████▌  | 15/20 [00:01<00:00, 12.45it/s]Testing clients:  85%|████████▌ | 17/20 [00:01<00:00, 12.84it/s]Testing clients:  95%|█████████▌| 19/20 [00:01<00:00, 12.92it/s]                                                                Calculating train metrics:   0%|          | 0/20 [00:00<?, ?it/s]Calculating train metrics:   5%|▌         | 1/20 [00:00<00:07,  2.48it/s]Calculating train metrics:  10%|█         | 2/20 [00:00<00:06,  2.69it/s]Calculating train metrics:  15%|█▌        | 3/20 [00:01<00:05,  2.88it/s]Calculating train metrics:  20%|██        | 4/20 [00:01<00:05,  3.03it/s]Calculating train metrics:  25%|██▌       | 5/20 [00:01<00:05,  2.79it/s]Calculating train metrics:  30%|███       | 6/20 [00:02<00:04,  2.83it/s]Calculating train metrics:  35%|███▌      | 7/20 [00:02<00:04,  2.64it/s]Calculating train metrics:  40%|████      | 8/20 [00:02<00:04,  2.71it/s]Calculating train metrics:  45%|████▌     | 9/20 [00:03<00:04,  2.71it/s]Calculating train metrics:  50%|█████     | 10/20 [00:03<00:03,  2.64it/s]Calculating train metrics:  55%|█████▌    | 11/20 [00:04<00:03,  2.57it/s]Calculating train metrics:  60%|██████    | 12/20 [00:04<00:03,  2.49it/s]Calculating train metrics:  65%|██████▌   | 13/20 [00:05<00:03,  2.31it/s]Calculating train metrics:  70%|███████   | 14/20 [00:05<00:02,  2.48it/s]Calculating train metrics:  75%|███████▌  | 15/20 [00:05<00:01,  2.63it/s]Calculating train metrics:  80%|████████  | 16/20 [00:06<00:01,  2.68it/s]Calculating train metrics:  85%|████████▌ | 17/20 [00:06<00:01,  2.63it/s]Calculating train metrics:  90%|█████████ | 18/20 [00:06<00:00,  2.74it/s]Calculating train metrics:  95%|█████████▌| 19/20 [00:07<00:00,  2.88it/s]Calculating train metrics: 100%|██████████| 20/20 [00:07<00:00,  2.83it/s]                                                                          Averaged Train Loss: 2.1611
Averaged Local Test Accuracy: 0.3410
Averaged Global Test Accuracy: 0.2000
Averaged Test AUC: 0.6819
Std Test Accuracy: 0.1403
Std Test AUC: 0.0437
Collecting models:   0%|          | 0/20 [00:00<?, ?it/s]                                                         Aggregating models:   0%|          | 0/20 [00:00<?, ?it/s]Aggregating models:  20%|██        | 4/20 [00:00<00:00, 37.88it/s]Aggregating models:  40%|████      | 8/20 [00:00<00:00, 18.45it/s]Aggregating models:  70%|███████   | 14/20 [00:00<00:00, 26.86it/s]Aggregating models:  90%|█████████ | 18/20 [00:00<00:00, 27.99it/s]                                                                   ------------------------- time cost ------------------------- 30.821523904800415

Best accuracy.
0.423

Average time cost per round.
29.557213497161865
File path: ../results/Cifar10_pat_nc20_FedProx_train_0.h5

Average time cost: 183.93s.
Length:  6
std for best accuracy: 0.0
mean for best accuracy: 0.423
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 166618996 	Used Memory: 439.95M
-------------------------------------------------------------------------------
